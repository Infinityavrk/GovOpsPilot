<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ Natural Language Support</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .input-label {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            display: block;
        }

        .problem-input {
            width: 100%;
            min-height: 120px;
            padding: 20px;
            border: 3px solid #ecf0f1;
            border-radius: 15px;
            font-size: 1.1em;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }

        .problem-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .examples {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .examples h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .example-item {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #3498db;
        }

        .example-item:hover {
            background: #e3f2fd;
            transform: translateX(5px);
        }

        .create-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .create-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }

        .create-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .processing {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #ecf0f1;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .result {
            display: none;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .result.success {
            border-left: 5px solid #27ae60;
        }

        .ticket-info {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .info-item {
            text-align: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .info-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 5px;
        }

        .info-label {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .flow-status {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 1px solid #e1e8ed;
        }

        .flow-progress {
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
            color: #2c3e50;
        }

        .flow-step {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 12px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid #bdc3c7;
            transition: all 0.3s ease;
        }

        .flow-step.pending {
            border-left-color: #bdc3c7;
            opacity: 0.6;
        }

        .flow-step.processing {
            border-left-color: #f39c12;
            background: rgba(243, 156, 18, 0.1);
            animation: pulse-orange 2s infinite;
        }

        .flow-step.completed {
            border-left-color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }

        .flow-step.error {
            border-left-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        @keyframes pulse-orange {

            0%,
            100% {
                box-shadow: 0 0 5px rgba(243, 156, 18, 0.3);
            }

            50% {
                box-shadow: 0 0 15px rgba(243, 156, 18, 0.6);
            }
        }

        .step-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #bdc3c7;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1em;
            font-weight: bold;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .step-icon.processing {
            background: #f39c12;
            animation: spin-icon 2s linear infinite;
        }

        .step-icon.completed {
            background: #27ae60;
        }

        .step-icon.error {
            background: #e74c3c;
        }

        @keyframes spin-icon {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .step-description {
            font-size: 0.9em;
            color: #7f8c8d;
            line-height: 1.4;
        }

        .step-time {
            font-size: 0.8em;
            color: #95a5a6;
            margin-top: 5px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Natural Language Support</h1>
            <p>Just describe your problem in plain language - we'll handle the rest!</p>
        </div>

        <div class="main-content">
            <div class="input-section">
                <label class="input-label">What's your problem? (Describe in your own words)</label>
                <textarea class="problem-input" id="problem-description"
                    placeholder="Example: Aadhaar authentication is not working in Indore and it's urgent..."
                    maxlength="500"></textarea>
            </div>

            <div class="examples">
                <h3>üí° Example Problems (Click to use):</h3>
                <div class="example-item" onclick="useExample(this)">
                    Aadhaar authentication services are failing in Indore - this is critical!
                </div>
                <div class="example-item" onclick="useExample(this)">
                    Payment gateway timeout issues in Bhopal affecting our business
                </div>
                <div class="example-item" onclick="useExample(this)">
                    I cannot access the citizen portal from Gwalior, please help
                </div>
                <div class="example-item" onclick="useExample(this)">
                    Mobile app keeps crashing when I try to download certificate
                </div>
            </div>

            <button class="create-btn" onclick="createTicket()" id="create-btn">
                üöÄ Create Support Ticket
            </button>

            <div class="processing" id="processing">
                <div class="spinner"></div>
                <p><strong>ü§ñ AI is analyzing your problem...</strong></p>
                <p>Determining department, priority, and creating your ticket</p>
            </div>

            <div class="result" id="result">
                <h3>‚úÖ Support Ticket Created Successfully!</h3>
                <div class="ticket-info" id="ticket-info">
                    <!-- Ticket details will be populated here -->
                </div>
                <div class="flow-status">
                    <h4>üè≠ Complete Production Flow Status:</h4>

                    <div class="flow-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-text" id="progress-text">0 of 9 steps completed</div>
                    </div>

                    <div class="flow-step pending" id="step-ai">
                        <div class="step-icon" id="icon-ai">ü§ñ</div>
                        <div class="step-content">
                            <div class="step-title">AI Analysis & Classification</div>
                            <div class="step-description">Analyzing natural language and extracting ticket information
                            </div>
                            <div class="step-time" id="time-ai"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-dynamodb">
                        <div class="step-icon" id="icon-dynamodb">üì¶</div>
                        <div class="step-content">
                            <div class="step-title">DynamoDB Storage</div>
                            <div class="step-description">Storing ticket with streams enabled for real-time processing
                            </div>
                            <div class="step-time" id="time-dynamodb"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-eventbridge">
                        <div class="step-icon" id="icon-eventbridge">‚è∞</div>
                        <div class="step-content">
                            <div class="step-title">EventBridge Monitoring</div>
                            <div class="step-description">Starting 5-minute SLA monitoring and event-driven workflows
                            </div>
                            <div class="step-time" id="time-eventbridge"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-sagemaker">
                        <div class="step-icon" id="icon-sagemaker">üß†</div>
                        <div class="step-content">
                            <div class="step-title">SageMaker ML Prediction</div>
                            <div class="step-description">Running ML models for breach probability and resolution time
                                prediction</div>
                            <div class="step-time" id="time-sagemaker"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-stepfunctions">
                        <div class="step-icon" id="icon-stepfunctions">üîÑ</div>
                        <div class="step-content">
                            <div class="step-title">Step Functions Workflow</div>
                            <div class="step-description">Executing escalation and mitigation workflows</div>
                            <div class="step-time" id="time-stepfunctions"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-alerts">
                        <div class="step-icon" id="icon-alerts">üìß</div>
                        <div class="step-content">
                            <div class="step-title">SNS/SES Alerts</div>
                            <div class="step-description">Sending notifications to stakeholders and support teams</div>
                            <div class="step-time" id="time-alerts"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-quicksight">
                        <div class="step-icon" id="icon-quicksight">üìä</div>
                        <div class="step-content">
                            <div class="step-title">QuickSight Dashboard</div>
                            <div class="step-description">Updating real-time dashboards and analytics</div>
                            <div class="step-time" id="time-quicksight"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-archive">
                        <div class="step-icon" id="icon-archive">üóÑÔ∏è</div>
                        <div class="step-content">
                            <div class="step-title">S3/Athena Archive</div>
                            <div class="step-description">Archiving data for analytics and compliance</div>
                            <div class="step-time" id="time-archive"></div>
                        </div>
                    </div>

                    <div class="flow-step pending" id="step-retraining">
                        <div class="step-icon" id="icon-retraining">üîÑ</div>
                        <div class="step-content">
                            <div class="step-title">ML Model Retraining</div>
                            <div class="step-description">Updating ML models with new data for continuous improvement
                            </div>
                            <div class="step-time" id="time-retraining"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function useExample(element) {
            document.getElementById('problem-description').value = element.textContent.trim();
        }

        async function createTicket() {
            const description = document.getElementById('problem-description').value.trim();

            if (!description) {
                alert('Please describe your problem first');
                return;
            }

            // Show processing
            document.getElementById('create-btn').disabled = true;
            document.getElementById('processing').style.display = 'block';
            document.getElementById('result').style.display = 'none';

            try {
                // Call backend API
                const response = await fetch('/api/create-ticket', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        description: description,
                        user_info: {
                            type: 'web_user',
                            timestamp: new Date().toISOString()
                        }
                    })
                });

                const result = await response.json();

                if (result.success) {
                    displayResult(result.ticket, result.analysis);

                    // Show success
                    document.getElementById('processing').style.display = 'none';
                    document.getElementById('result').style.display = 'block';
                    document.getElementById('result').className = 'result success';

                    // Start production flow visualization
                    startProductionFlowVisualization(result.ticket);

                    console.log('üéâ Ticket created successfully:', result.ticket);
                } else {
                    throw new Error(result.error || 'Failed to create ticket');
                }

            } catch (error) {
                console.error('Error creating ticket:', error);

                // Fallback to local processing
                console.log('üîÑ Falling back to local processing...');
                const analysis = analyzeWithAI(description);
                const ticket = createTicketFromAnalysis(description, analysis);

                displayResult(ticket, analysis);

                // Show result
                document.getElementById('processing').style.display = 'none';
                document.getElementById('result').style.display = 'block';
                document.getElementById('result').className = 'result success';

                // Start production flow visualization
                startProductionFlowVisualization(ticket);

                // Process locally
                processTicketInBackground(ticket);
            }

            // Re-enable button
            document.getElementById('create-btn').disabled = false;
        }

        function analyzeWithAI(description) {
            const text = description.toLowerCase();

            // AI Department Analysis
            let department = 'MPOnline';
            let departmentConfidence = 0.6;

            if (text.includes('aadhaar') || text.includes('authentication') || text.includes('biometric')) {
                department = 'UIDAI';
                departmentConfidence = 0.95;
            } else if (text.includes('payment') || text.includes('gateway') || text.includes('transaction')) {
                department = 'MeiTY';
                departmentConfidence = 0.90;
            } else if (text.includes('portal') || text.includes('website') || text.includes('digital')) {
                department = 'DigitalMP';
                departmentConfidence = 0.88;
            } else if (text.includes('certificate') || text.includes('document') || text.includes('app')) {
                department = 'eDistrict';
                departmentConfidence = 0.85;
            }

            // AI Priority Analysis
            let priority = 'P3';
            let priorityReason = 'Standard issue';

            if (text.includes('critical') || text.includes('urgent') || text.includes('failing') || text.includes('down')) {
                priority = 'P1';
                priorityReason = 'Critical/Urgent keywords detected';
            } else if (text.includes('important') || text.includes('high') || text.includes('serious')) {
                priority = 'P2';
                priorityReason = 'High importance indicators';
            } else if (text.includes('minor') || text.includes('small') || text.includes('question')) {
                priority = 'P4';
                priorityReason = 'Low priority indicators';
            }

            // Location Detection
            const locations = ['mumbai', 'delhi', 'bangalore', 'hyderabad', 'chennai', 'kolkata',
                'pune', 'ahmedabad', 'jaipur', 'lucknow', 'kanpur', 'nagpur',
                'indore', 'bhopal', 'visakhapatnam', 'patna', 'vadodara', 'gwalior'];

            let location = 'Not specified';
            for (const loc of locations) {
                if (text.includes(loc)) {
                    location = loc.charAt(0).toUpperCase() + loc.slice(1);
                    break;
                }
            }

            // Service Type
            let serviceType = 'other';
            if (text.includes('aadhaar') || text.includes('authentication')) {
                serviceType = 'aadhaar-auth';
            } else if (text.includes('payment') || text.includes('gateway')) {
                serviceType = 'payment-gateway';
            } else if (text.includes('portal') || text.includes('website')) {
                serviceType = 'citizen-portal';
            } else if (text.includes('mobile') || text.includes('app')) {
                serviceType = 'mobile-app';
            } else if (text.includes('certificate') || text.includes('document')) {
                serviceType = 'certificate-services';
            }

            return {
                department,
                departmentConfidence,
                priority,
                priorityReason,
                location,
                serviceType,
                confidence: departmentConfidence
            };
        }

        function createTicketFromAnalysis(description, analysis) {
            const now = new Date();
            const dateStr = now.toISOString().slice(2, 10).replace(/-/g, '');
            const timeStr = now.toTimeString().slice(0, 5).replace(':', '');

            const ticketId = `${analysis.department}-${analysis.priority}-${dateStr}-${timeStr}`;

            // Calculate SLA
            const slaHours = {
                'P1': 2, 'P2': 8, 'P3': 24, 'P4': 72
            }[analysis.priority] || 24;

            const slaDeadline = new Date(now.getTime() + slaHours * 60 * 60 * 1000);

            // Calculate risk and impact
            const breachRisk = {
                'P1': 0.85, 'P2': 0.65, 'P3': 0.45, 'P4': 0.25
            }[analysis.priority] || 0.45;

            const revenueImpact = {
                'P1': 200000, 'P2': 100000, 'P3': 50000, 'P4': 20000
            }[analysis.priority] || 50000;

            return {
                ticketId,
                description,
                department: analysis.department,
                priority: analysis.priority,
                location: analysis.location,
                serviceType: analysis.serviceType,
                slaDeadline: slaDeadline.toLocaleTimeString('en-IN', { hour12: true }),
                slaHours,
                breachRisk,
                revenueImpact,
                confidence: analysis.confidence,
                createdAt: now.toISOString(),
                analysis
            };
        }

        function displayResult(ticket, analysis) {
            const ticketInfo = document.getElementById('ticket-info');

            ticketInfo.innerHTML = `
                <h4>üé´ Ticket: ${ticket.ticketId}</h4>
                
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-value">${ticket.department}</div>
                        <div class="info-label">Department</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">${ticket.priority}</div>
                        <div class="info-label">Priority</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">${ticket.location}</div>
                        <div class="info-label">Location</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">${ticket.slaDeadline}</div>
                        <div class="info-label">SLA Deadline</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">${(ticket.breachRisk * 100).toFixed(1)}%</div>
                        <div class="info-label">Breach Risk</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">$${ticket.revenueImpact.toLocaleString()}</div>
                        <div class="info-label">Revenue Impact</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(52, 152, 219, 0.1); border-radius: 10px;">
                    <h5>ü§ñ AI Analysis:</h5>
                    <p><strong>Department:</strong> ${analysis.department} (${(analysis.departmentConfidence * 100).toFixed(1)}% confidence)</p>
                    <p><strong>Priority:</strong> ${analysis.priority} - ${analysis.priorityReason}</p>
                    <p><strong>Service:</strong> ${analysis.serviceType}</p>
                </div>
            `;
        }

        function processTicketInBackground(ticket) {
            // Simulate backend processing
            console.log('üè≠ Processing ticket in background:', ticket);

            // In a real implementation, this would:
            // 1. Send ticket to backend API
            // 2. Store in DynamoDB
            // 3. Trigger EventBridge
            // 4. Start SageMaker analysis
            // 5. Execute Step Functions workflow
            // 6. Send alerts via SNS/SES
            // 7. Update QuickSight dashboard
            // 8. Archive to S3/Athena
            // 9. Trigger ML retraining

            // Save to localStorage for demo
            const tickets = JSON.parse(localStorage.getItem('natural_language_tickets') || '[]');
            tickets.push(ticket);
            localStorage.setItem('natural_language_tickets', JSON.stringify(tickets));

            // Simulate production flow steps
            setTimeout(() => console.log('‚úÖ DynamoDB: Ticket stored'), 1000);
            setTimeout(() => console.log('‚úÖ EventBridge: Monitoring started'), 2000);
            setTimeout(() => console.log('‚úÖ SageMaker: Analysis complete'), 3000);
            setTimeout(() => console.log('‚úÖ Step Functions: Workflow triggered'), 4000);
            setTimeout(() => console.log('‚úÖ SNS/SES: Alerts sent'), 5000);
            setTimeout(() => console.log('‚úÖ QuickSight: Dashboard updated'), 6000);
            setTimeout(() => console.log('‚úÖ S3/Athena: Data archived'), 7000);
            setTimeout(() => console.log('‚úÖ ML: Retraining triggered'), 8000);
            setTimeout(() => console.log('üéâ Complete production flow executed!'), 9000);
        }

        // Production Flow Visualization
        function startProductionFlowVisualization(ticket) {
            const steps = [
                { id: 'ai', name: 'AI Analysis', duration: 1000, description: `Classified as ${ticket.department} ${ticket.priority} with ${(ticket.confidence_score * 100).toFixed(1)}% confidence` },
                { id: 'dynamodb', name: 'DynamoDB Storage', duration: 1500, description: `Ticket ${ticket.ticketId || ticket.ticket_id} stored with streams enabled` },
                { id: 'eventbridge', name: 'EventBridge Monitoring', duration: 1200, description: `5-minute SLA monitoring started for ${ticket.priority} ticket` },
                { id: 'sagemaker', name: 'SageMaker ML Prediction', duration: 2000, description: `Breach probability: ${(ticket.breachRisk || ticket.breach_probability * 100).toFixed(1)}%, Revenue impact: $${(ticket.revenueImpact || ticket.revenue_impact).toLocaleString()}` },
                { id: 'stepfunctions', name: 'Step Functions Workflow', duration: 1800, description: `Escalation workflow initiated for ${ticket.department} department` },
                { id: 'alerts', name: 'SNS/SES Alerts', duration: 1000, description: ticket.priority === 'P1' ? 'Immediate P1 alert sent to stakeholders' : 'Standard notification sent to support team' },
                { id: 'quicksight', name: 'QuickSight Dashboard', duration: 1500, description: 'Real-time dashboards updated with new ticket metrics' },
                { id: 'archive', name: 'S3/Athena Archive', duration: 1200, description: 'Ticket data archived for analytics and compliance' },
                { id: 'retraining', name: 'ML Model Retraining', duration: 1000, description: 'ML training pipeline updated with new data point' }
            ];

            let completedSteps = 0;
            const totalSteps = steps.length;
            window.flowStartTime = Date.now();

            // Process each step
            steps.forEach((step, index) => {
                setTimeout(() => {
                    executeFlowStep(step, () => {
                        completedSteps++;
                        updateProgress(completedSteps, totalSteps);

                        if (completedSteps === totalSteps) {
                            showFlowCompletion(ticket);
                        }
                    });
                }, index * 800); // Stagger the steps
            });
        }

        function executeFlowStep(step, onComplete) {
            const stepElement = document.getElementById(`step-${step.id}`);
            const iconElement = document.getElementById(`icon-${step.id}`);
            const timeElement = document.getElementById(`time-${step.id}`);

            // Set to processing state
            stepElement.className = 'flow-step processing';
            iconElement.className = 'step-icon processing';

            // Update description
            const descElement = stepElement.querySelector('.step-description');
            descElement.textContent = `Processing ${step.name.toLowerCase()}...`;

            // Show start time
            timeElement.textContent = `Started: ${new Date().toLocaleTimeString()}`;

            // Simulate processing
            setTimeout(() => {
                // Set to completed state
                stepElement.className = 'flow-step completed';
                iconElement.className = 'step-icon completed';
                iconElement.textContent = '‚úì';

                // Update description with result
                descElement.textContent = step.description;

                // Show completion time
                timeElement.textContent = `Completed: ${new Date().toLocaleTimeString()}`;

                onComplete();
            }, step.duration);
        }

        function updateProgress(completed, total) {
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');

            const percentage = (completed / total) * 100;
            progressFill.style.width = `${percentage}%`;
            progressText.textContent = `${completed} of ${total} steps completed (${percentage.toFixed(0)}%)`;
        }

        function showFlowCompletion(ticket) {
            setTimeout(() => {
                // Add completion message
                const flowStatus = document.querySelector('.flow-status');
                const completionDiv = document.createElement('div');
                completionDiv.style.cssText = `
                    background: linear-gradient(135deg, #27ae60, #2ecc71);
                    color: white;
                    padding: 20px;
                    border-radius: 15px;
                    margin-top: 20px;
                    text-align: center;
                    font-weight: bold;
                `;
                completionDiv.innerHTML = `
                    <h4>üéâ Complete Production Flow Executed Successfully!</h4>
                    <p>Ticket ${ticket.ticketId || ticket.ticket_id} is now fully processed and monitored</p>
                    <p>Total processing time: ${((Date.now() - window.flowStartTime) / 1000).toFixed(1)} seconds</p>
                `;

                flowStatus.appendChild(completionDiv);
            }, 1000);
        }

        // Auto-focus on the textarea when page loads
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('problem-description').focus();
        });
    </script>
</body>

</html>